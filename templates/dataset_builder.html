{% extends "base.html" %}
{% set active = "dataset" %}
{% block content %}

<div class="container-fluid">

  <!-- PAGE HEADER -->
  <h3 class="fw-bold mb-3">Dataset Builder — Synthetic Data Generation</h3>
  <p class="text-muted">
    Generate custom synthetic datasets with configurable features, class parameters,
    and sampling controls. The generated dataset is automatically analyzed using
    exploratory data analysis (EDA).
  </p>

  <div class="row g-3">

    <!-- =====================================================
         LEFT PANEL — CONFIGURATION
    ====================================================== -->
    <div class="col-lg-4">
      <div class="card p-3 shadow-sm">
        <h5 class="fw-semibold mb-2">Configuration</h5>

        <!-- Feature Names -->
        <label class="form-label mt-2">
          Feature Names <span class="text-muted">(comma-separated)</span>
        </label>
        <input
          id="featureNames"
          class="form-control"
          placeholder="length,width,density,pH"
        >

        <!-- Class Names -->
        <label class="form-label mt-3">
          Class Names <span class="text-muted">(comma-separated)</span>
        </label>
        <input
          id="classNames"
          class="form-control"
          placeholder="Ampalaya,Banana,Cabbage"
        >

        <!-- Class Settings -->
        <div id="classSettings" class="mt-3">
          <p class="small text-muted mb-1">
            Set Gaussian distribution parameters (mean and standard deviation) for each class.
          </p>
        </div>

        <!-- Number of Samples -->
        <label class="form-label mt-3">Number of Samples</label>
        <input
          type="range"
          id="sampleCount"
          class="form-range"
          min="500"
          max="20000"
          step="500"
          value="5000"
        >
        <p class="mb-0">
          <strong id="sampleCountLabel">5000</strong> samples
        </p>

        <!-- Random Seed -->
        <label class="form-label mt-3">Random Seed</label>
        <input
          id="seed"
          type="number"
          class="form-control"
          value="42"
        >

        <!-- Generate Button -->
        <button
          id="btnGenerateDataset"
          class="btn btn-primary w-100 mt-3"
        >
          <i class="bi bi-gear"></i>
          Generate Dataset
        </button>

        <!-- Alerts -->
        <div id="dsAlerts" class="mt-3"></div>
      </div>
    </div>

    <!-- =====================================================
         RIGHT PANEL — PREVIEW & EDA
    ====================================================== -->
    <div class="col-lg-8">

      <!-- DATASET PREVIEW -->
      <div class="card p-3 shadow-sm">
        <h5 class="fw-semibold">Dataset Preview</h5>
        <p class="text-muted small mb-2">
          After generating the dataset, you may download the CSV file
          or proceed to model training.
        </p>

        <div id="datasetPreview" class="text-muted">
          No dataset generated yet.
        </div>
      </div>

      <!-- EDA SECTION -->
      <div class="card p-3 shadow-sm mt-3">
        <h5 class="fw-semibold">Exploratory Data Analysis (EDA)</h5>
        <p class="small text-muted">
          Automatically generated visualizations showing data distribution,
          variability, correlation, and class separability.
        </p>

        <div id="edaPreviewArea" class="row g-3 mt-2">
          <!-- Dynamically filled by main.js -->
        </div>
      </div>

    </div>
  </div>
</div>

<!-- =====================================================
     INLINE UI HELPER SCRIPT
     (UI ONLY — NO BACKEND LOGIC)
====================================================== -->
<script>
  const classInput = document.getElementById("classNames");
  const classSettings = document.getElementById("classSettings");

  classInput.addEventListener("input", () => {
    const classes = classInput.value
      .split(",")
      .map(c => c.trim())
      .filter(Boolean);

    classSettings.innerHTML = "";

    classes.forEach(cls => {
      classSettings.innerHTML += `
        <div class="border rounded p-2 mb-2">
          <strong>${cls}</strong>
          <div class="row g-2 mt-1">
            <div class="col">
              <input
                class="form-control mean-input"
                data-class="${cls}"
                type="number"
                value="50"
                placeholder="Mean"
              >
            </div>
            <div class="col">
              <input
                class="form-control std-input"
                data-class="${cls}"
                type="number"
                value="10"
                placeholder="Std Dev"
              >
            </div>
          </div>
        </div>
      `;
    });
  });

  const slider = document.getElementById("sampleCount");
  const label = document.getElementById("sampleCountLabel");

  slider.addEventListener("input", () => {
    label.textContent = slider.value;
  });
</script>

{% endblock %}
